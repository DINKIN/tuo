#Overview of Robin

= Compile =

Have a look at readme on
[https://www2.hosted-projects.com/trac/ansanto/robin/browser/compiling_robin]

= Flash =

[http://www.open-mesh.com/activekb/questions/8/Flashing+the+Accton+Mini-Router+with+ROBIN]
{{{
   1.Boot your Linux computer (or Live CD) and bring up a terminal window (under "Applications", then "Accessories", then "terminal" on Ubuntu)

   2.Make sure it is connected to the internet, then type the following to download the files you will need:

      sudo apt-get upgrade
      sudo apt-get install wget
      wget http://www.open-mesh.com/flashing/openwrt-atheros-2.6-vmlinux.gz
      wget http://www.open-mesh.com/flashing/openwrt-atheros-2.6-root.jffs2-64k
      wget http://www.open-mesh.com/flashing/easyflash
      wget http://www.open-mesh.com/flashing/flash
      chmod +x easyflash
      chmod +x flash

   3.Plug in your Accton or FON 2200 (check the bottom label for the model number) to your Ethernet LAN port on your computer. *Use a cross linked cable. sudo ifconfig eth0 up*
   
      Type: ./flash (note: If your router is NOT connected to eth0, modify the file "flash" accordingly.)

   5.Plug in the router to A/C power.

   6.You should see something like this displayed:

      No packet
      No packet
      Peer MAC: 00:18:84:80:67:1C (this will be the MAC address of your router)
      You MAC: 00:ba:be:ca:ff:ee
      Your IP: 192.168.1.0
      Setting IP address...
      Loading rootfs...
      Sending rootfs. xxxx blocks...
      Initializing partiions...
      Rootfs partition size now 0x006f0000
      Flashing rootfs...
      Loading Kernel...
      Sending kernel, xxxx blocks...
      Flashing Kernel...
      Setting boot_script_data...

      Done. Restarting device...

   7.Go get lunch. This will take 15-30 minutes, depending upon the flash chip speed in your router. DO NOT INTERRUPT!

   8.When it is done, the Flash Utility will automatically close. 
}}}


= Update =

Robin update its information to server by http/https.
  * crond -c /etc/crontabs. Crond execute scheduled commands. /etc/crontabs/root as follow
{{{
0-59/5  * * * * /sbin/update
22              * * * * /sbin/upgrade
}}}
  First line run the script /sbin/update every 5 minutes to update the information to server.
  Second line run the script /sbin/upgrade on 22 minutes for each hour to upgrade the firmware.
  This file format detail can be found in crontab.
  * /etc/update/ directory contains all update related file. Log is in /tmp/update.log
  * /etc/update/received.clean contains the configuration from the server. /etc/update/update.arg is the uploading information from the local in url format.
  * The scripts in /usr/sbin/update-* will use the file in /etc/update to update the node.

= UCI =

/bin/uci is a script to access the configuration file. It use the /etc/functions.sh and the scripts on /lib/config to access the configuration files on /etc/config

= watchout4node =

script /sbin/watchout4node watch the follow aspects:
  * well known MadWifi/Atheros bugs
  * low memory
  * batmand
  * gateway upstream router connection
  * name server
  * internet connection
  * misc

  According the check results, the node will reboot or /sbin/node_restart

= Nodogsplash =

Nodogsplash offers a simple way to provide restricted access to an internet connection. It is intended for use on wireless access points running OpenWRT (but may also work on other Linux-based devices).

== Speed Limit ==

For open access ap, there are download and upload limit. But I didn't figure out how to set this value on the node.

= DHCP =

DNSMasq works as DHCP server on open mesh AP very well. But it can't work with MySecure.

= Routing Table =

To have a look robin's routing table, you should use ip rule and ip route show table XX instead of route, which just output the main routing table. The follow is an example.

{{{
root@open-mesh:/# ip rule
0:      from all lookup local 
6600:   from all to 5.0.0.0/8 lookup 66 
6699:   from all lookup 65 
6700:   from all to 5.0.0.0/8 lookup 67 
6800:   from all iif lo lookup 68 
6801:   from 127.0.0.0/8 lookup 68 
6802:   from 10.104.234.0/25 lookup 68 
6803:   from 10.104.234.128/25 lookup 68 
32766:  from all lookup main 
32767:  from all lookup default 
root@open-mesh:/# 
root@open-mesh:/# /usr/sbin/ip route show table local
broadcast 10.104.234.255 dev ath2  proto kernel  scope link  src 10.104.234.129 
broadcast 127.255.255.255 dev lo  proto kernel  scope link  src 127.0.0.1 
broadcast 5.0.0.0 dev ath0  proto kernel  scope link  src 5.128.104.234 
local 169.254.0.1 dev gate0  proto kernel  scope host  src 169.254.0.1 
broadcast 10.104.234.127 dev br-lan  proto kernel  scope link  src 10.104.234.1 
broadcast 10.104.234.0 dev br-lan  proto kernel  scope link  src 10.104.234.1 
local 10.104.234.1 dev br-lan  proto kernel  scope host  src 10.104.234.1 
broadcast 10.104.234.128 dev ath2  proto kernel  scope link  src 10.104.234.129 
broadcast 5.255.255.255 dev ath0  proto kernel  scope link  src 5.128.104.234 
local 5.128.104.234 dev ath0  proto kernel  scope host  src 5.128.104.234 
local 10.104.234.129 dev ath2  proto kernel  scope host  src 10.104.234.129 
broadcast 127.0.0.0 dev lo  proto kernel  scope link  src 127.0.0.1 
local 127.0.0.1 dev lo  proto kernel  scope host  src 127.0.0.1 
local 127.0.0.0/8 dev lo  proto kernel  scope host  src 127.0.0.1 
root@open-mesh:/# 
root@open-mesh:/# /usr/sbin/ip route show table 68   
throw 10.104.234.0/25  proto static 
throw 10.104.234.128/25  proto static 
throw 5.0.0.0/8  proto static 
throw 127.0.0.0/8  proto static 
default dev gate0  proto static  scope link  src 169.254.0.1 
}}}

*Important: You have to use /usr/sbin/ip instead of /bin/ip*